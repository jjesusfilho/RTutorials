---
title: "Tidy Data"
author: "Erin Grand"
date: "July 7, 2017"
output: revealjs::revealjs_presentation
---

# Tidy Data

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
opts_chunk$set(collapse = FALSE)
library(tidyverse)
library(fivethirtyeight)
```


## Tidy data

<div class="centered">
![](https://github.com/eringrand/RTutorials/blob/master/Lesson1/images/tidy-1.jpg)
</div>

### The essence of tidy data is:
  
1. Each variable forms a column
1. Each observation forms a row
1. Each type of observational unit forms a table

---

### Why?

- Standardized
- Easier for you and others to analyze
- Easier for the computer to analyze
- Easier to go from Tidy format into other formats if needed

---

Example: Is this untidy or tidy data?

```{r, collapse=T, echo=FALSE}
fivethirtyeight::airline_safety %>%
  select(airline, incidents_85_99:fatalities_00_14) %>%
  head()
```

---

Is this tidy data?
```{r, collapse=T, echo=FALSE}
dplyr::starwars %>% head()
```




# Cleaning and restructuring data


## Step 1:  Make sure it imported correctly  

- Are your column types correct?
- Are all the columns and rows there?
- How about your headers (if you have them)?
- Did R give you any warnings?
- Look at your data!


## Step 2:  Tidy it up

- Think about how you want your data structured for analysis
- What are your observations?  What are your variables?  Do you need multiple tables to capture your data better?
- Use `tidyr::gather()` and `tidyr::spread()` to appropriately transform your data
- If you have super messy data with lots of code needed to clean it up, save the cleaned data separately for the final analysis output.

# Gather and Spread

---
        
tidyr |	`gather`|	`spread`
------|-------|---------
reshape2	|`melt`	| `cast`
spreadsheets |	unpivot	| pivot
databases	| fold	| unfold

---



## Pipes: Ceci n'est pas un pipe

Don't forget to use your pipes!

```{r}
iris %>% 
	gather(petal_measurments, value, -Species) %>% 
	group_by(Species, petal_measurments) %>% 
	summarise(mean = mean(value))
```




# Unite and Seperate

## Unite is a concatate function.
- You define the name of the new column, and the ones you want to combine, in the order you wish to do so

```{r, eval=FALSE}
unite(temp, school, grade)
```

Creates columns called "temp" from school and grade. 
 
- You can also set the separator value with sep=" ", the default is "snake case" i.e sep="_"

```{r, eval=FALSE}
unite(temp, school, grade, sep="")
```


## separate
The opposite of unite!
- separates values in a single column into new columns
- Works best when every value in the column has the same number of possible elements to separate
- If not, fill parameter 
- Define what the split is with sep="_". The default value is any non-alpha-numeric values (.,_...etc)

## Practice
Subject, Raw Score, Scaled Score -> ELA Raw Score, ELA Scaled Score, Math Raw Score, Math Scaled Score

```{r, eval=FALSE}
df <- tibble(subject = c("ELA", "Math"), scaled_score = c(100, 200), raw_score = c(20, 50))

df %>% unite(temp, raw_score, scaled_score) %>%
  spread(subject, temp) %>%
  separate(ELA, c("ELA_raw_score", "ELA_scaled_score")) %>%
  separate(Math, c("Math_raw_score", "Math_scaled_score")) 
```


